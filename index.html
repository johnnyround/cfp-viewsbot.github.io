<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Telegram Web App</title>
</head>
<body>
    <h1>Telegram Web App</h1>
    <div id="user-info"></div>
    <a id="download-link" style="display: none;">Download User Data</a>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        function displayUserInfo(user) {
            if (user) {
                const userInfoText = `Имя: ${user.first_name}; user_id: ${user.id}; username: @${user.username}`;
                document.getElementById('user-info').innerText = userInfoText;

                // Создаем файл с данными пользователя
                const userData = `${user.first_name}|${user.id}|${user.username}\n`;
                const blob = new Blob([userData], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);

                // Создаем ссылку для скачивания файла
                const downloadLink = document.getElementById('download-link');
                downloadLink.href = url;
                downloadLink.download = 'usersBase.txt';
                downloadLink.style.display = 'block';
                downloadLink.innerText = 'Скачать данные пользователя';
            } else {
                document.getElementById('user-info').innerText = 'Не удалось получить данные пользователя.';
            }
        }

        const user = Telegram.WebApp.initDataUnsafe.user;
        displayUserInfo(user);

        Telegram.WebApp.MainButton.setText('Обновить данные');
        Telegram.WebApp.MainButton.show();

        Telegram.WebApp.onEvent('mainButtonClicked', function() {
            displayUserInfo(Telegram.WebApp.initDataUnsafe.user);
        });
    </script>
</body>
</html>
